import java.util.*;


public class DefenseManager {

    private static int firewall_score = 0;
    private static int antivirus_score = 50;
    public static int crypto_score = 0;
    public static  int obfusc_score = 0;
    public static int budget = 20;

    private List<String> installedSoftware;

    public DefenseManager() {
        installedSoftware = new ArrayList<>();

        Timer timer = new Timer();
        timer.schedule(new TimerTask() {

            @Override
            public void run() {
                budget+=1;
            }
        }, 0, 3000);
    }
    private static boolean confirm_buy(DefensiveSoftware dfs){
        System.out.println("Budget restant : " + budget);
        System.out.println("Prix : " + dfs.getPrice());
        System.out.println(dfs.getDescription());
        System.out.println("\n\u001B[33mEtes-vous sur(e) de vouloir acheter \u001B[36m"+ dfs.getName() + " \u001B[33m?\u001B[0m");

        String reponse = new Scanner(System.in).nextLine();
        if(reponse.equals("oui")){
            return(true);
        } else{
            return false;
        }
    }
    public void installSoftware(DefensiveSoftware software){
        if(!isInstalled(software)){
            if (confirm_buy(software)){
                software.install();
                firewall_score += software.firewallScore;
                antivirus_score += software.antivirusScore;
                crypto_score += software.cryptoScore;
                obfusc_score += software.obfuscScore;
                installedSoftware.add(software.getName());
                budget -= software.price;
            }
        }else{
            System.out.println("\u001B[31m[!]\u001B[0m Vous avez déjà installé ce logiciel.");

        }
    }

    public List<String> getInstalledSoftware() {
        return installedSoftware;
    }

    public String print_info() {
        String info = String.format("\n             ,----------------,              ,---------,\n" +
                "        ,-----------------------,          ,\"        ,\"|\n" +
                "      ,\"                      ,\"|        ,\"        ,\"  |\n" +
                "     +-----------------------+  |      ,\"        ,\"    |\n" +
                "     |  .-----------------.  |  |     +---------+      |\n" +
                "     |  | \u001B[32mAntivirus : %s\u001B[0m |  |  |     | -==----'|      |\n" +
                "     |  | \u001B[32mFirewall  : %s\u001B[0m |  |  |     |         |      |\n" +
                "     |  | \u001B[32mChiffremt : %s\u001B[0m |  |  |/----|`---=    |      |\n" +
                "     |  | \u001B[32mObfusc    : %s\u001B[0m |  |  |   ,/|==== ooo |      ;\n" +
                "     |  | \u001B[32mC:\\>_\u001B[0m           |  |  |  // |(((( [33]|    ,\"\n" +
                "     |  `-----------------'  |,\" .;'| |((((     |  ,\"\n" +
                "     +-----------------------+  ;;  | |         |,\"\n" +
                "        /_)______________(_/  //'   | +---------+\n\nBUDGET: %d $\n", String.format("%03d", antivirus_score), String.format("%03d", firewall_score), String.format("%03d", crypto_score), String.format("%03d", obfusc_score), budget);
        return (info);
    }

    public boolean isInstalled(DefensiveSoftware software) {
        return installedSoftware.contains(software.getName());
    }
    public String printIsInstalled(DefensiveSoftware software) {
        if(installedSoftware.contains(software.getName())){
            return("\u001B[32mInstallé\u001B[0m");

        }
        else{
            return "";
        }
    }


    public void getScores() {
        System.out.println("firewall_score = " + firewall_score);
        System.out.println("antivirus_score = " + antivirus_score);
        System.out.println("crypto_score = " + crypto_score);
        System.out.println("obfusc_score = " + obfusc_score);
    }
}
